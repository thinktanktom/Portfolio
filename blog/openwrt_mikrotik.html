<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Flash OpenWRT on MikroTik Routers Using Initramfs (2025 Guide)</title>
    <meta name="description" content="Step-by-step guide to flash OpenWRT on MikroTik RouterBoard using initramfs method. Complete tutorial with TFTP server setup, troubleshooting, and best practices.">
    <meta name="keywords" content="OpenWRT, MikroTik, RouterBoard, initramfs, TFTP server, router flashing, OpenWRT installation, MikroTik OpenWRT">
    <meta name="author" content="Thomas Cyriac">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.8;
            color: #2d3748;
            background: #f7fafc;
        }

        .blog-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 100px 20px 60px;
            text-align: center;
        }

        .blog-header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        .blog-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .blog-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px 20px;
            background: white;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.1);
        }

        .toc {
            background: #edf2f7;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 40px;
            border-left: 4px solid #667eea;
        }

        .toc h2 {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #2d3748;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            margin: 10px 0;
        }

        .toc a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        h2 {
            font-size: 2rem;
            font-weight: 700;
            margin: 50px 0 25px;
            color: #2d3748;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 35px 0 20px;
            color: #4a5568;
        }

        h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 25px 0 15px;
            color: #718096;
        }

        p {
            margin: 20px 0;
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .highlight-box {
            background: #fff5e6;
            border-left: 4px solid #f6ad55;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff0f0;
            border-left: 4px solid #fc8181;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        .info-box {
            background: #e6f7ff;
            border-left: 4px solid #4299e1;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }

        code {
            background: #2d3748;
            color: #68d391;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 25px 0;
            line-height: 1.6;
        }

        pre code {
            background: none;
            padding: 0;
            color: #68d391;
        }

        ul, ol {
            margin: 20px 0 20px 30px;
        }

        li {
            margin: 12px 0;
            line-height: 1.8;
        }

        .requirements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .requirement-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }

        .requirement-card h4 {
            margin-top: 0;
            color: #667eea;
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-right: 10px;
        }

        .author-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 60px;
            text-align: center;
        }

        .author-box h3 {
            color: white;
            margin-top: 0;
        }

        .author-box a {
            color: white;
            text-decoration: underline;
        }

        .github-link {
            display: inline-block;
            background: white;
            color: #667eea;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 20px;
            transition: transform 0.3s ease;
        }

        .github-link:hover {
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .blog-header h1 {
                font-size: 1.8rem;
            }

            h2 {
                font-size: 1.6rem;
            }

            .blog-meta {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <header class="blog-header">
        <h1>How to Flash OpenWRT on MikroTik Routers Using Initramfs</h1>
        <div class="blog-meta">
            <span>üìÖ By Thomas Cyriac</span>
            <span>‚è±Ô∏è 15 min read</span>
            <span>üîß Advanced Tutorial</span>
        </div>
    </header>

    <article class="blog-container">
        <div class="toc">
            <h2>üìã Table of Contents</h2>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#why-openwrt">Why Flash OpenWRT on MikroTik?</a></li>
                <li><a href="#prerequisites">Prerequisites & Requirements</a></li>
                <li><a href="#step1">Step 1: Setting Up TFTP Server Directory</a></li>
                <li><a href="#step2">Step 2: Preparing Boot Files</a></li>
                <li><a href="#step3">Step 3: Configuring Vagrant VM</a></li>
                <li><a href="#step4">Step 4: Installing dnsmasq</a></li>
                <li><a href="#step5">Step 5: Creating the Loader Script</a></li>
                <li><a href="#step6">Step 6: Flashing OpenWRT</a></li>
                <li><a href="#troubleshooting">Troubleshooting Common Issues</a></li>
                <li><a href="#conclusion">Conclusion</a></li>
            </ul>
        </div>

        <section id="introduction">
            <h2>Introduction</h2>
            <p>
                MikroTik RouterBoards are powerful, affordable networking devices that run RouterOS out of the box. However, many network enthusiasts and professionals prefer OpenWRT for its flexibility, open-source nature, and extensive package ecosystem. In this comprehensive guide, I'll walk you through the process of flashing OpenWRT on MikroTik routers using the initramfs method.
            </p>
            <p>
                This tutorial is based on my personal experience working with network infrastructure and builds upon the excellent <a href="https://openwrt.org/toh/mikrotik/common" target="_blank">OpenWRT MikroTik documentation</a>. Whether you're a network engineer, homelab enthusiast, or blockchain developer (like myself) needing custom router firmware for development environments, this guide will help you get OpenWRT running on your MikroTik hardware.
            </p>

            <div class="info-box">
                <strong>üí° Note:</strong> This method uses initramfs, which means OpenWRT will boot into RAM. On reboot, the router will revert to RouterOS. This is perfect for testing before committing to a permanent installation.
            </div>
        </section>

        <section id="why-openwrt">
            <h2>Why Flash OpenWRT on MikroTik?</h2>
            <p>
                Before diving into the technical steps, let's understand why you might want to run OpenWRT instead of RouterOS:
            </p>
            <ul>
                <li><strong>Open Source Flexibility:</strong> OpenWRT is fully open-source, allowing complete customization and transparency</li>
                <li><strong>Extensive Package Repository:</strong> Access to thousands of additional packages not available in RouterOS</li>
                <li><strong>Development & Testing:</strong> Perfect for creating custom network configurations and testing environments</li>
                <li><strong>VPN & Privacy Tools:</strong> Easier integration with modern VPN protocols and privacy tools</li>
                <li><strong>Learning Platform:</strong> Ideal for understanding networking at a deeper level</li>
                <li><strong>Cost-Effective:</strong> Get enterprise-grade features on affordable MikroTik hardware</li>
            </ul>

            <div class="highlight-box">
                <strong>üéØ Use Cases:</strong> In my blockchain development work, I've used this setup to create isolated network environments for testing DeFi applications, running blockchain nodes, and managing secure development networks.
            </div>
        </section>

        <section id="prerequisites">
            <h2>Prerequisites & Requirements</h2>
            <p>
                Before starting, ensure you have the following hardware and software ready:
            </p>

            <div class="requirements-grid">
                <div class="requirement-card">
                    <h4>Hardware</h4>
                    <ul style="margin-left: 20px;">
                        <li>MikroTik RouterBoard (tested on RB951Ui-2nD)</li>
                        <li>Ethernet cable</li>
                        <li>Host machine (Linux recommended)</li>
                    </ul>
                </div>
                <div class="requirement-card">
                    <h4>Software</h4>
                    <ul style="margin-left: 20px;">
                        <li>Vagrant or VM software</li>
                        <li>Nix Package Manager (optional)</li>
                        <li>WinBox or web browser</li>
                    </ul>
                </div>
                <div class="requirement-card">
                    <h4>Skills Needed</h4>
                    <ul style="margin-left: 20px;">
                        <li>Basic Linux command line</li>
                        <li>Understanding of networking</li>
                        <li>Familiarity with TFTP/DHCP</li>
                    </ul>
                </div>
            </div>

            <div class="info-box">
                <strong>üíª My Setup:</strong> I'm using NixOS as my host operating system, which provides excellent reproducibility and package management. However, this guide works on any Linux distribution, macOS, or even Windows with appropriate virtualization software.
            </div>
        </section>

        <section id="step1">
            <h2><span class="step-number">1</span>Setting Up TFTP Server Directory</h2>
            <p>
                First, we need to create a directory structure for our TFTP server. This will host the OpenWRT boot files that the router will download during the flashing process.
            </p>

            <h3>Create the Directory Structure</h3>
            <pre><code># Create main TFTP directory
mkdir ~/tftpserver/
cd ~/tftpserver/

# Create subdirectory for boot files
mkdir srv/</code></pre>

            <p>
                This simple structure keeps everything organized. The <code>srv/</code> directory will contain the OpenWRT initramfs image specific to your MikroTik model.
            </p>

            <div class="highlight-box">
                <strong>üîß Pro Tip:</strong> Keep your TFTP directories organized by router model if you're planning to flash multiple devices. For example: <code>srv/rb951ui/</code>, <code>srv/rb750/</code>, etc.
            </div>
        </section>

        <section id="step2">
            <h2><span class="step-number">2</span>Preparing Boot Files</h2>
            <p>
                Download the appropriate OpenWRT initramfs image for your specific MikroTik model from the <a href="https://openwrt.org/" target="_blank">official OpenWRT website</a>. Place this file in the <code>srv/</code> directory you just created.
            </p>

            <h3>Configure RouterBoot Settings</h3>
            <p>
                Now we need to configure the MikroTik router to boot via network (DHCP/TFTP):
            </p>
            <ol>
                <li>Connect your Ethernet cable to <strong>port 1</strong> of your router</li>
                <li>Connect the other end to your host machine</li>
                <li>Access your router via WinBox or web browser</li>
                <li>Navigate to <code>System ‚Üí RouterBoot ‚Üí Settings</code></li>
                <li>Change <strong>Boot method</strong> to <strong>DHCP</strong></li>
            </ol>

            <div class="warning-box">
                <strong>‚ö†Ô∏è Important:</strong> If you can't access the router via WinBox through the eth1 port, try connecting the cable to port 2 for configuration. However, the actual flashing process <strong>must</strong> occur through port 1.
            </div>
        </section>

        <section id="step3">
            <h2><span class="step-number">3</span>Configuring Vagrant VM</h2>
            <p>
                We'll use Vagrant to create a lightweight Alpine Linux VM that will act as our TFTP/DHCP server. This approach provides isolation and reproducibility.
            </p>

            <h3>Initialize Vagrant</h3>
            <pre><code>cd ~/tftpserver/
vagrant init alpine/alpine64</code></pre>

            <h3>Configure Network Bridge</h3>
            <p>
                Edit the generated <code>Vagrantfile</code> and add the following configuration to bridge the VM to your router's network:
            </p>
            <pre><code>config.vm.network "public_network", dev: "network_interface_placeholder"</code></pre>

            <p>
                Replace <code>network_interface_placeholder</code> with your actual network interface name (e.g., <code>eth0</code>, <code>enp0s3</code>). You can find this using <code>ip addr</code> or <code>ifconfig</code>.
            </p>

            <h3>Boot the VM</h3>
            <pre><code># Start the VM
vagrant up

# SSH into the VM
vagrant ssh

# Set root password (you'll need this later)
sudo passwd root</code></pre>

            <h3>Transfer Boot Files to VM</h3>
            <p>
                From your <strong>host machine</strong> (in a new terminal), copy the initramfs file to the VM:
            </p>
            <pre><code>scp tftpserver/srv/openwrt-23.05.0-ath79-mikrotik-mikrotik_routerboard-951ui-2nd-*.bin \
    vagrant@192.168.121.*:/home/vagrant/</code></pre>

            <div class="info-box">
                <strong>üí° Note:</strong> Replace <code>192.168.121.*</code> with your VM's actual IP address. You can find this by running <code>ip addr</code> inside the VM.
            </div>
        </section>

        <section id="step4">
            <h2><span class="step-number">4</span>Installing and Configuring dnsmasq</h2>
            <p>
                <code>dnsmasq</code> is a lightweight DNS/DHCP/TFTP server perfect for this task. Let's install it in the VM:
            </p>
            <pre><code># Update package repository
sudo apk update

# Install dnsmasq
sudo apk add dnsmasq

# Verify installation
which dnsmasq</code></pre>

            <p>
                The <code>which dnsmasq</code> command should return <code>/usr/sbin/dnsmasq</code>, confirming successful installation.
            </p>
        </section>

        <section id="step5">
            <h2><span class="step-number">5</span>Creating the Loader Script</h2>
            <p>
                This is the core of our setup. We'll create a bash script that configures the network interface and starts dnsmasq with the appropriate DHCP/TFTP settings.
            </p>

            <h3>Create loader.sh</h3>
            <p>
                In the VM, create a file named <code>loader.sh</code> with the following content:
            </p>
            <pre><code>#!/bin/bash

# Network interface (connected to router)
IFNAME=eth1

# Assign static IP to interface
/sbin/ip addr replace 192.168.88.10/24 dev $IFNAME
/sbin/ip link set dev $IFNAME up

# Start dnsmasq with TFTP/DHCP configuration
/usr/sbin/dnsmasq \
    --no-daemon \
    --listen-address 192.168.88.10 \
    --bind-interfaces \
    -p0 \
    --dhcp-authoritative \
    --dhcp-range=192.168.88.100,192.168.88.200 \
    --bootp-dynamic \
    --dhcp-boot=/home/vagrant/openwrt-23.05.0-*-initramfs-* \
    --log-dhcp \
    --enable-tftp \
    --tftp-root=/home/vagrant/</code></pre>

            <h3>Understanding the Script</h3>
            <ul>
                <li><code>--listen-address 192.168.88.10</code>: IP address of our TFTP/DHCP server</li>
                <li><code>--dhcp-range</code>: IP range for DHCP clients (the router)</li>
                <li><code>--dhcp-boot</code>: Path to the initramfs file the router will download</li>
                <li><code>--enable-tftp</code>: Enables TFTP server functionality</li>
                <li><code>--tftp-root</code>: Directory containing boot files</li>
                <li><code>--log-dhcp</code>: Shows DHCP activity (useful for debugging)</li>
            </ul>

            <h3>Set Permissions</h3>
            <pre><code># Make script executable
chmod +x loader.sh

# Ensure initramfs file has correct permissions
chmod 644 /home/vagrant/openwrt-23.05.0-ath79-mikrotik-mikrotik_routerboard-951ui-2nd-*.bin</code></pre>
        </section>

        <section id="step6">
            <h2><span class="step-number">6</span>Flashing OpenWRT</h2>
            <p>
                Now comes the exciting part ‚Äì actually booting OpenWRT on your MikroTik router!
            </p>

            <h3>Start the TFTP Server</h3>
            <p>
                In your VM, run the loader script as root:
            </p>
            <pre><code>su
./loader.sh</code></pre>

            <p>
                The script will start and you'll see log output. Keep this terminal open and visible.
            </p>

            <h3>Boot the Router</h3>
            <ol>
                <li><strong>Power off</strong> your MikroTik router</li>
                <li><strong>Press and hold</strong> the reset button</li>
                <li><strong>Power on</strong> the router while still holding reset</li>
                <li><strong>Hold for 15-20 seconds</strong> or until you see DHCP activity in the VM terminal</li>
                <li><strong>Release</strong> the reset button</li>
            </ol>

            <div class="highlight-box">
                <strong>üéâ Success Indicators:</strong> You should see DHCP requests and TFTP file transfers in your VM terminal. The router's LEDs may flash in a specific pattern indicating boot mode.
            </div>

            <h3>Access OpenWRT</h3>
            <p>
                Once the boot process completes (usually 1-2 minutes), access OpenWRT in your web browser:
            </p>
            <pre><code>http://192.168.1.1/</code></pre>

            <p>
                Default credentials are typically:
            </p>
            <ul>
                <li><strong>Username:</strong> root</li>
                <li><strong>Password:</strong> (empty/blank)</li>
            </ul>

            <div class="info-box">
                <strong>üí° Remember:</strong> This is an initramfs boot, meaning OpenWRT is running from RAM. If you reboot the router, it will return to RouterOS. To make OpenWRT permanent, you'll need to follow additional installation steps in the OpenWRT interface.
            </div>
        </section>

        <section id="troubleshooting">
            <h2>Troubleshooting Common Issues</h2>
            
            <h3>Issue 1: Can't Access Router Configuration</h3>
            <p>
                If you can't access your router via WinBox or browser to change the boot method:
            </p>
            <ul>
                <li>Try connecting to different ports (port 2 sometimes works better for initial access)</li>
                <li>Reset the router to defaults by holding reset for 15-20 seconds while powered on</li>
                <li>Check that your host machine is on the same subnet (192.168.88.x)</li>
            </ul>

            <h3>Issue 2: Router Doesn't Boot from Network</h3>
            <p>
                If the router isn't requesting an IP or downloading the boot file:
            </p>
            <ul>
                <li>Verify cable is connected to <strong>port 1</strong></li>
                <li>Ensure boot method is set to DHCP in RouterBoot settings</li>
                <li>Check that loader.sh is running and showing in the VM terminal</li>
                <li>Try holding reset button for full 20 seconds during power-on</li>
            </ul>

            <h3>Issue 3: Network Interface Configuration</h3>
            <p>
                For NixOS users, if the router isn't accessible even after configuration:
            </p>
            <pre><code># Add to configuration.nix
networking.firewall.enable = false;
networking.interfaces.&lt;network_interface&gt; = {
  ipv4.addresses = [{
    address = "192.168.88.2";
    prefixLength = 24;
  }];
  useDHCP = true;
};</code></pre>

            <h3>Issue 4: OpenWRT Web Interface Not Loading</h3>
            <p>
                If OpenWRT boots but the web interface at 192.168.1.1 doesn't load:
            </p>
            <ul>
                <li>Change your host machine's IP to 192.168.1.x (e.g., 192.168.1.100)</li>
                <li>Try accessing via SSH: <code>ssh root@192.168.1.1</code></li>
                <li>Wait 2-3 minutes for full boot completion</li>
                <li>Check connection using ping: <code>ping 192.168.1.1</code></li>
            </ul>

            <h3>Emergency Reset</h3>
            <div class="warning-box">
                <strong>‚ö†Ô∏è Last Resort:</strong> If everything fails and your router is inaccessible:
                <ol>
                    <li>Power off the router</li>
                    <li>Hold reset button</li>
                    <li>Power on while holding reset for 15-20 seconds</li>
                    <li>Access via WinBox or browser</li>
                    <li>Go to <code>System ‚Üí Reset Configuration</code></li>
                    <li>Reset to default RouterOS settings</li>
                </ol>
            </div>
        </section>

        <section id="conclusion">
            <h2>Conclusion</h2>
            <p>
                Congratulations! You've successfully flashed OpenWRT on your MikroTik router using the initramfs method. This setup provides a safe, reversible way to test OpenWRT without permanently modifying your router's firmware.
            </p>

            <h3>Next Steps</h3>
            <ul>
                <li><strong>Make it Permanent:</strong> If you're happy with OpenWRT, you can install it permanently using the sysupgrade process</li>
                <li><strong>Configure Packages:</strong> Install additional packages from OpenWRT's repository using <code>opkg</code></li>
                <li><strong>Set Up Services:</strong> Configure VPN, DNS, firewall, or whatever services you need</li>
                <li><strong>Backup Configuration:</strong> Always backup your working configurations</li>
            </ul>

            <h3>Why This Matters</h3>
            <p>
                As a blockchain developer, having control over your network infrastructure is crucial. OpenWRT enables:
            </p>
            <ul>
                <li>Custom routing for blockchain nodes</li>
                <li>Advanced firewall rules for development environments</li>
                <li>VPN configurations for secure remote development</li>
                <li>Traffic analysis and monitoring for DApp testing</li>
            </ul>

            <div class="highlight-box">
                <strong>üöÄ Learning Experience:</strong> This project taught me valuable lessons about network protocols, TFTP servers, and firmware flashing ‚Äì skills that have proven useful in my blockchain development work, particularly when setting up secure development environments and understanding how decentralized networks communicate at lower levels.
            </div>
        </section>

        <div class="author-box">
            <h3>About the Author</h3>
            <p>
                <strong>Thomas Cyriac</strong> is a blockchain developer and AI engineer with 4+ years of experience. 
                Specializing in smart contract development, DeFi protocols, and DevOps, he maintains a 100% job success rate on Upwork with over $100K earned.
            </p>
            <p>
                This guide is part of his technical blog series covering blockchain development, network infrastructure, and system administration.
            </p>
            <a href="https://github.com/thinktanktom/OpenWRT-Initram-Flash" target="_blank" class="github-link">
                üìÇ View Full Project on GitHub
            </a>
            <div style="margin-top: 20px;">
                <a href="https://github.com/thinktanktom" style="margin: 0 10px;">GitHub</a> ‚Ä¢
                <a href="https://www.upwork.com/freelancers/thinktanktom" style="margin: 0 10px;">Upwork</a> ‚Ä¢
                <a href="mailto:thomas.e.cyriac@gmail.com" style="margin: 0 10px;">Email</a>
            </div>
        </div>

        <div style="margin-top: 50px; padding-top: 30px; border-top: 2px solid #e2e8f0;">
            <p style="font-size: 0.9rem; color: #718096;">
                <strong>Tags:</strong> OpenWRT, MikroTik, RouterBoard, Network Engineering, TFTP Server, Firmware Flashing, 
                Linux, DevOps, Homelab, Network Infrastructure, Router Configuration, Alpine Linux, Vagrant
            </p>
        </div>
    </article>
</body>
</html>